# Binary Exploitation

| Binary Exploitation  |
| ------------- |
| [Binary Exploitation is Ez](#1-binary-exploitation-is-ez-896-pts)|

## 1. Binary Exploitation is Ez (896 pts)

### Soal: 
Take a break, here's an easy problem

nc 128.199.157.172 23170

Alternate download link:
https://drive.google.com/file/d/1C7h5xwmmqBFL74w2Z8x1gpjFwrPxSVB8/view?usp=sharing

### Pembahasan:
Diberikan sebuah file ELF dan source code Kita cek dahulu filenya, didapatkan
File ELF 64-bit, not stripped
lebih lanjut:
```
ez: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, BuildID[sha1]=1f06ce37d5440a134161e552b12f7cd04dc66821, for GNU/Linux 3.2.0, not stripped
```
informasi checksec
```
    Arch:     amd64-64-little
    RELRO:    Full RELRO
    Stack:    Canary found
    NX:       NX enabled
    PIE:      No PIE (0x400000)
```
setelah melihat source code, program membuat meme baru dengan size tidak boleh lebih dari 0x200 dan dibatasi pembuatan tidak boleh lebih dari 8. ada bug pada editMeme, dimana kita bisa membuat heap buffer overflow. kami memanfaatkan bug ini untuk overwrite pointer <code>my_print</code> dengan <code>EZ_WIN</code> untuk mendapatkan shell. 
kami membuat 8 meme, lalu mengedit konten pertama dengan <code>EZ_WIN</code> lalu <code>print_meme</code>
```
void edit_meme()  {
  unsigned int idx;
  printf("Index: ");
  idx = read_int();
  if(memes[idx] == NULL)  {
    puts("There's no meme there!");
    return;
  }
  printf("Enter meme content: ");
  gets(memes[idx]->content);
  puts("Done!");
}
```
berikut script yang kami buat [klik disini](https://github.com/ahm4ddm/Arsip-WU/blob/binary/Compfest%202020/Binary%20Exploitation/binary-exploitation-is-ez/explo.py)

<details>
<summary>Flagnya</summary>
COMPFEST12{C_i_told_u_its_ez_loooooooool_257505}
</details>
